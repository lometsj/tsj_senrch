模拟一般审计人员在审计敏感信息打印的工作流
首先检索有哪些日志打印的函数
对于每个日志打印函数，查找所有调用处
对于调用处，分析调用时的参数是否包含敏感信息
如果当前参数来自上方，则向上分析数据流。如果参数是结构体，则查找结构体定义。

大模型可以通过请求json来获取更多信息，比如某个函数的信息，某个宏定义的信息，某个结构体的信息

## cursor
自动生成的代码改了一堆f-string的bug
然后openai的api用的老的，要手动改成新的
cscope解析读行号但实际读的是文件名

## batch_mode
对于一个问题类型，同时合并多个引用的函数一起分析如果触发了model的token上限，就砍半数量再尝试，一直到一个可以分析的数量

## 扩展问题类型
应实现problem 类，类里可以使用symbol解析类和解析config，需要自己实现找到引用点的功能和准备prompt的功能
框架先根据get_code获取一个待办任务list
然后对每个元素，让类自己生成一个prompt加上框架自己的prompt形成一个任务的prompt


## 不同的问题类型整理

### 敏感信息打印
找打印函数，看变量%s有没有问题，有时候光看变量名不行

### 内存泄露
找malloc函数，如果一个函数里malloc了后，指针既没有参数传出，也没有返回值传出，也没有放到某个参数的结构体里，还跟全局变量没关系，那就说明有内存泄露问题

### 命令注入
类似敏感信息打印，直接找命令执行的函数如system execve等，查看字符串命令是否拼接外部可控的字符串，注意看有没有过滤

### UAF
如果一个指针指向的内存被释放了，但是指针本身没有被置空，那么就说明有UAF问题

### memcpy
如果一个函数里调用了memcpy，但是没有检查目标缓冲区的大小，就可能存在缓冲区溢出问题

### 未初始化的变量
如果一个变量在定义时没有初始化，就可能会包含敏感信息

### 未检查的返回值
如果一个函数的返回值没有检查，就可能导致缓冲区溢出

### 内核的copy_from_user copy_to_user容易导致缓冲区溢出
